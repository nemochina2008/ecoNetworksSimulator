---
title: "Lorenz Equations"
author: "Stephen Gaito"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Lorenz Equations}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r echo=FALSE}
library(rgl)
library(rglwidget)
library(dynSysToolKit)
rgl.open()
rgl.bg(color="white")
.setupKnitr()
```

## Model equations

We investigate the [Lorenz Equations](https://en.wikipedia.org/wiki/Lorenz_system) using the RGL graphics tool. A good [A complete guide to 3D visualization device system in R - R software and data visualization](http://www.sthda.com/english/wiki/a-complete-guide-to-3d-visualization-device-system-in-r-r-software-and-data-visualization#install-the-rgl-package) provides an excellent tutorial. To learn how to adjust the mouse buttons see: [Translation using mouse for rgl plot](http://stackoverflow.com/questions/23996006/translation-using-mouse-for-rgl-plot)

Consider using the tools [deSolve](https://cran.r-project.org/web/packages/deSolve/index.html) and [rootSolve](https://cran.r-project.org/web/packages/rootSolve/index.html)

$$
\begin{align*}
\frac{dx}{dt} & = & \sigma ( y - x ) \\
\frac{dy}{dt} & = & x ( \rho - z ) - y \\
\frac{dz}{dt} & = & x y - \beta z
\end{align*}
$$

Where interesting values for sigma, rho and beta are:

$$
\begin{align*}
\sigma & = & 10 \\
\rho   & = & 28 \\
\beta  & = & \frac{8}{3}
\end{align*}
$$

```{r}
results <- integrateLorenz()
rgl.linestrips(results[,1], results[,2], results[,3], color = "blue")
subid <- currentSubscene3d()
rglwidget(elementId = "lorenzEq")
```
